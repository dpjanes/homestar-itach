/*
 *  IRAppleTV.js
 *
 *  David Janes
 *  IOTDB
 *  2015-06-28
 */

var iotdb = require("iotdb");
var _ = iotdb._;

var cmdd = {
    "media.cursor.down": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,85,21,3648", 
    "media.cursor.left": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,85,21,3648", 
    "media.cursor.right": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,21,21,65,21,65,21,21,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,86,21,3648", 
    "media.cursor.up": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,21,21,65,21,21,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,85,21,3648", 
    "media.enter": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,65,21,21,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,85,21,3648", 
    "media.exit": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1508,341,85,21,3648", 
    "media.play": "sendir,1:1,1,38000,1,69,341,172,21,21,21,65,21,65,21,65,21,21,21,65,21,65,21,65,21,65,21,65,21,65,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,65,21,21,21,21,21,21,21,21,21,21,21,65,21,65,21,21,21,21,21,21,21,65,21,21,21,21,21,1509,341,86,21,3649", 
};

cmdd["media.pause"] = cmdd["media.play"];

exports.Model = iotdb.make_model('IRAppleTV')
    .facet(":bridge.media")
    .name("IR Apple TV")
    .description("Apple TV via IR channel")
    .action("iot-attribute:media.cursor.down")
    .action("iot-attribute:media.cursor.left")
    .action("iot-attribute:media.cursor.right")
    .action("iot-attribute:media.cursor.up")
    .action("iot-attribute:media.enter")
    .action("iot-attribute:media.exit")
    .action("iot-attribute:media.play")
    .action("iot-attribute:media.pause")
    .make();

exports.binding = {
    bridge: require('../ITachIRBridge').Bridge,
    model: exports.Model,
    connectd: {
        data_out: function(paramd) {
            paramd.rawd.irs = [];

            for (var key in paramd.cookd) {
                var ir = cmdd[key];
                if (ir) {
                    paramd.rawd.irs.push(ir);
                }
            }
        }
    },
};
